[phases.setup]
nixPkgs = ["nodejs", "npm"]

[phases.install]
cmds = ["npm install"]

[phases.build]
cmds = [
  "npx prisma generate --schema=./packages/database/prisma/schema.prisma",
  "cd packages/database && npm run build && cd ../..",
  "cd packages/ai-client && npm run build && cd ../..",
  "cd packages/utils && npm run build && cd ../..",
  "cd services/api-gateway && npm run build && cd ../.."
]

[start]
cmd = "cd services/api-gateway && node dist/services/api-gateway/src/index.js"
